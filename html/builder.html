<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Catacomb Linux Mobile</title>
    <meta name="description" content="Catacomb is a set of Linux Wayland
    applications for mobile Linux platforms like the PinePhone. All applications
    are optimized to run on low-end hardware with a limited battery life.">
    <link rel="stylesheet" href="../css/base.css" type="text/css" media="all">
    <link rel="stylesheet" href="../css/builder.css" type="text/css" media="all">
    <script type="text/javascript" src="../js/md5.js"></script>
  </head>
  <body>
    <div class="description-container">
      <h1>Archlinux ARM Image Creator</h1>
      <p>
        This page allows you to create your own custom Archlinux ARM image for
        use with the PinePhone (Pro). Images are compiled on demand and should be
        ready in 5-10 minutes with an empty build queue.
      </p>
    </div>

    <div class="option-groups">
      <div>
        <h3>Device</h3>
        <input type="radio" id="device-pinephone-pro" name="device" value="pinephone-pro" checked="checked">
        <label for="device-pinephone-pro">PinePhone Pro</label><br>
        <input type="radio" id="device-pinephone" name="device" value="pinephone">
        <label for="device-pinephone">PinePhone</label><br>
        <input type="radio" id="device-fairphone-fp5" name="device" value="fairphone-fp5">
        <label for="device-fairphone-fp5">Fairphone 5 <p class="alpha">(alpha)</p></label><br>
      </div>

      <div>
        <h3>Desktop Environment</h3>
        <input type="radio" id="de-none" name="de" value="none" onChange="deChanged(this)" checked="checked">
        <label for="de-none">None</label><br>
        <input type="radio" id="de-catacomb" name="de" value="catacomb" onChange="deChanged(this)">
        <label for="de-catacomb">Catacomb</label><br>
        <input type="radio" id="de-sxmo" name="de" value="sxmo" onChange="deChanged(this)">
        <label for="de-sxmo">Simple X Mobile</label><br>
        <input type="radio" id="de-phosh" name="de" value="phosh" onChange="deChanged(this)">
        <label for="de-phosh">Phosh</label><br>
        <input type="radio" id="de-plasma" name="de" value="plasma" onChange="deChanged(this)">
        <label for="de-plasma">Plasma Mobile</label><br>
      </div>

      <div>
        <h3>Audio</h3>
        <input type="radio" id="audio-pipewire" name="audio" value="pipewire" checked="checked">
        <label for="audio-pipewire">Pipewire</label><br>
        <input type="radio" id="audio-pulse" name="audio" value="pulseaudio">
        <label for="audio-pulse">Pulseaudio</label><br>
      </div>

      <div>
        <h3>Compositor</h3>
        <input type="checkbox" id="comp-catacomb" name="comp-catacomb" value="catacomb">
        <label for="comp-catacomb">Catacomb</label><br>
        <input type="checkbox" id="comp-sway" name="comp-sway" value="sway">
        <label for="comp-sway">Sway</label><br>
      </div>

      <div>
        <h3>On-Screen Keyboard</h3>
        <input type="checkbox" id="osk-squeekboard" name="osk-squeekboard" value="squeekboard">
        <label for="osk-squeekboard">Squeekboard</label><br>
        <input type="checkbox" id="osk-wvkbd" name="osk-wvkbd" value="wvkbd">
        <label for="osk-wvkbd">Wvkbd</label><br>
      </div>

      <div>
        <h3>Application Launcher</h3>
        <input type="checkbox" id="launcher-tzompantli" name="launcher-tzompantli" value="tzompantli">
        <label for="launcher-tzompantli">Tzompantli</label><br>
        <input type="checkbox" id="launcher-bemenu" name="launcher-bemenu" value="bemenu-wayland">
        <label for="launcher-bemenu">Bemenu</label><br>
      </div>

      <div>
        <h3>Panel</h3>
        <input type="checkbox" id="panel-epitaph" name="panel-epitaph" value="epitaph">
        <label for="panel-epitaph">Epitaph</label><br>
      </div>

      <div>
        <h3>Wallpaper</h3>
        <input type="checkbox" id="wp-tabula" name="wp-tabula" value="tabula">
        <label for="wp-tabula">Tabula</label><br>
        <input type="checkbox" id="wp-swaybg" name="wp-swaybg" value="swaybg">
        <label for="wp-swaybg">Swaybg</label><br>
      </div>

      <div>
        <h3>Browser</h3>
        <input type="checkbox" id="browser-kumo" name="browser-kumo" value="kumo ffmpeg">
        <label for="browser-kumo">Kumo</label><br>
        <input type="checkbox" id="browser-ff-mobile" name="browser-ff-mobile" value="mobile-config-firefox">
        <label for="browser-ff-mobile">Firefox Mobile</label><br>
        <input type="checkbox" id="browser-ff" name="browser-ff" value="firefox">
        <label for="browser-ff">Firefox</label><br>
        <input type="checkbox" id="browser-angelfish" name="browser-angelfish" value="angelfish">
        <label for="browser-angelfish">Angelfish</label><br>
      </div>

      <div>
        <h3>Terminal</h3>
        <input type="checkbox" id="terminal-alacritty" name="terminal-alacritty" value="alacritty">
        <label for="terminal-alacritty">Alacritty</label><br>
        <input type="checkbox" id="terminal-foot" name="terminal-foot" value="foot">
        <label for="terminal-foot">Foot</label><br>
        <input type="checkbox" id="terminal-gnome" name="terminal-gnome" value="gnome-console">
        <label for="terminal-gnome">Gnome Console</label><br>
        <input type="checkbox" id="terminal-qmlkonsole" name="terminal-qmlkonsole" value="qmlkonsole">
        <label for="terminal-qmlkonsole">QMLKonsole</label><br>
      </div>

      <div>
        <h3>Editor</h3>
        <input type="checkbox" id="editor-vim" name="editor-vim" value="vim">
        <label for="editor-vim">Vim</label><br>
        <input type="checkbox" id="editor-neovim" name="editor-neovim" value="neovim">
        <label for="editor-neovim">NeoVim</label><br>
        <input type="checkbox" id="editor-emacs" name="editor-emacs" value="emacs">
        <label for="editor-emacs">Emacs</label><br>
        <input type="checkbox" id="editor-gnome" name="editor-gnome" value="gnome-text-editor">
        <label for="editor-gnome">Gnome Text Editor</label><br>
        <input type="checkbox" id="editor-maui" name="editor-maui" value="maui-nota">
        <label for="editor-maui">Maui Nota</label><br>
        <input type="checkbox" id="editor-nano" name="editor-nano" value="nano">
        <label for="editor-nano">Nano</label><br>
      </div>

      <div>
        <h3>Clock</h3>
        <input type="checkbox" id="clock-catacomb" name="clock-catacomb" value="aevum">
        <label for="clock-catacomb">Aevum</label><br>
        <input type="checkbox" id="clock-gnome" name="clock-gnome" value="gnome-clocks-mobile">
        <label for="clock-gnome">Gnome Clocks</label><br>
        <input type="checkbox" id="clock-kclock" name="clock-kclock" value="kclock">
        <label for="clock-kclock">Kclock</label><br>
      </div>

      <div>
        <h3>Calls</h3>
        <input type="checkbox" id="calls-gnome" name="calls-gnome" value="gnome-calls">
        <label for="calls-gnome">Gnome Calls</label><br>
        <input type="checkbox" id="calls-plasma" name="calls-plasma" value="plasma-dialer">
        <label for="calls-plasma">Plasma Dialer</label><br>
      </div>

      <div>
        <h3>SMS</h3>
        <input type="checkbox" id="sms-chatty" name="sms-chatty" value="chatty">
        <label for="sms-chatty">Chatty</label><br>
        <input type="checkbox" id="sms-spacebar" name="sms-spacebar" value="spacebar">
        <label for="sms-spacebar">Spacebar</label><br>
      </div>

      <div>
        <h3>Camera</h3>
        <input type="checkbox" id="camera-megapixels" name="camera-megapixels" value="megapixels postprocessd">
        <label for="editor-megapixels">Megapixels</label><br>
      </div>

      <div>
        <h3>Music</h3>
        <input type="checkbox" id="music-lollypop" name="music-lollypop" value="lollypop">
        <label for="music-lollypop">Lollypop</label><br>
        <input type="checkbox" id="music-elisa" name="music-elisa" value="elisa">
        <label for="music-elisa">Elisa</label><br>
      </div>

      <div>
        <h3>Image Viewer</h3>
        <input type="checkbox" id="img-imv" name="img-imv" value="imv">
        <label for="img-imv">Imv</label><br>
        <input type="checkbox" id="img-eog" name="img-eog" value="eog">
        <label for="img-eog">Eye of Gnome</label><br>
        <input type="checkbox" id="img-koko" name="img-koko" value="koko">
        <label for="img-koko">Koko</label><br>
      </div>

      <div>
        <h3>File Manager</h3>
        <input type="checkbox" id="fm-portfolio" name="fm-portfolio" value="portfolio-file-manager">
        <label for="fm-portfolio">Portfolio</label><br>
        <input type="checkbox" id="fm-indexfm" name="fm-indexfm" value="index-fm">
        <label for="fm-indexfm">Index FM</label><br>
      </div>

      <div>
        <h3>Maps</h3>
        <input type="checkbox" id="maps-charon" name="maps-charon" value="charon">
        <label for="maps-charon">Charon</label><br>
        <input type="checkbox" id="maps-gnome" name="maps-gnome" value="gnome-maps">
        <label for="maps-gnome">Gnome Maps</label><br>
      </div>

      <div>
        <h3>Other</h3>
        <input type="checkbox" id="misc-swayidle" name="misc-swayidle" value="swayidle">
        <label for="misc-swayidle">Swayidle</label><br>
        <input type="checkbox" id="misc-grim" name="misc-grim" value="grim slurp">
        <label for="misc-grim">Grim + Slurp</label><br>
        <input type="checkbox" id="misc-wfrecorder" name="misc-wfrecorder" value="wf-recorder slurp">
        <label for="misc-wfrecorder">wf-recorder + Slurp</label><br>
        <input type="checkbox" id="misc-mako" name="misc-mako" value="mako">
        <label for="misc-mako">Mako</label><br>
        <input type="checkbox" id="misc-pinax" name="misc-pinax" value="pinax">
        <label for="misc-pinax">Pinax</label><br>
        <input type="checkbox" id="misc-gorm" name="misc-gorm" value="gorm">
        <label for="misc-gorm">Gorm</label><br>
      </div>
    </div>

    <div class="submit-button-container">
      <button type="button" onclick="submit()">Build Image</button>
    </div>

    <div id="download-popup" class="popup" style="display: none">
      <div class="popup-content">
        <p>Image is ready for download.</p>
        <p>Compressed image MD5 checksum: <code id="img-md5sum"></code></p>
        <div class="popup-buttons">
          <button type="button" onclick="cancelPopup()">Cancel</button>
          <button type="button" onclick="confirmDownload()">Download</button>
        </div>

        <div id="fp5-instructions" class="instructions" style="display: none">
          <p>Installation instructions:<p>
          <ul>
            <li>
              Unlock your bootloader:
              <a href="https://wiki.postmarketos.org/wiki/Fairphone_5_(fairphone-fp5)#Preparing_for_the_installation">
                Fairphone 5 Preparation
              </a>
            </li>
            <li class="list-separator"></li>
            <li>
              Download u-boot image:

              <a href="https://catacombing.org/catacomb/u-boot-fairphone-fp5.img.xz">
                U-Boot Image
              </a>
            </li>
            <li>
              Download boot filesystem image:

              <a href="https://catacombing.org/catacomb/alarm-fairphone-fp5-boot.img.xz">
                Boot Filesystem Image
              </a>
            </li>
            <li>Download root filesystem image ("Download" button above)</li>
            <li class="list-separator"></li>
            <li>Enter the bootloader</li>
            <li class="list-separator"></li>
            <li>
              Flash the u-boot image to the <code>boot</code> partition:

              <div class="code">
                #&gt; xz -d u-boot-fairphone-fp5.img.xz<br/>
                #&gt; fastboot flash boot u-boot-fairphone-fp5.img
              </div>
            </li>
            <li>
              Flash the boot filesystem image to the <code>super</code> partition:

              <div class="code">
                #&gt; xz -d alarm-fairphone-fp5-boot.img.xz<br/>
                #&gt; fastboot flash super alarm-fairphone-fp5-boot.img
              </div>
            </li>
            <li>
              Flash the root filesystem image to the <code>userdata</code> partition:

              <div class="code">
                #&gt; xz -d alarm-fairphone-fp5-root.img.xz<br/>
                #&gt; fastboot flash userdata alarm-fairphone-fp5-root.img
              </div>
            </li>
            <li class="list-separator"></li>
            <li>
              Reboot the device:

              <div class="code">
                #&gt; fastboot reboot
              </div>
            </li>
          </ul>
        </div>

        <div id="pp-instructions" class="instructions" style="display: none">
          <p>Installation instructions:<p>
          <div class="code">
            xzcat image.img.xz | dd of=&lt;eMMC or SD card device&gt; conv=fsync
          </div>
        </div>
      </div>
    </div>

    <div id="start-build-popup" class="popup" style="display: none">
      <div class="popup-content">
        <p>Image does not exist yet, do you want to start a new build?</p>
        <p>This will take at least 5 minutes, but this site does not need to stay open.</p>
        <div class="popup-buttons">
          <button type="button" onclick="cancelPopup()">Cancel</button>
          <button type="button" onclick="confirmBuild()">Confirm</button>
        </div>
      </div>
    </div>

    <div id="pending-popup" class="popup" style="display: none">
      <div class="popup-content">
        <p>Waiting for image to build, this could take a whileâ€¦</p>
        <p>The page will refresh automatically once the build is complete.</p>
      </div>
    </div>

    <div id="error-popup" class="popup" style="display: none">
      <div class="popup-content">
        <p>An unexpected error occurred, please try again at a later time.</p>
      </div>
    </div>
  </body>

  <script type="text/javascript" src="../js/builder.js"></script>
</html>
